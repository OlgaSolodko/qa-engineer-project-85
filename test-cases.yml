---
- summary: |
    Проверка успешной регистрации
  requirement: |
    Пользователь может зарегистрироваться с помощью электронной почты
  prerequisites: |
    empty
  test-data: |
    empty
  steps:
    - Нажать на кнопку Sign up
    - Ввести Nickname
    - Ввести Email
    - Ввести Password
    - Ввести Password Confirmation
    - Нажать Submit
  expected-result: |
    Пользователь успешно зарегистрирован


- summary: |
    Проверка авторизации через Github
  requirement: |
    Пользователь может авторизоваться с помощью Github
  prerequisites: |
    Созданный аккаунт Github
  test-data: |
    empty
  steps: 
    - Нажать на кнопку Sign up
    - Нажать кнопку "Sign in with Github"
  expected-result: |
    Пользователь успешно авторизован


- summary: |
    Проверка авторизации через Discord
  requirement: |
    Пользователь может авторизоваться через Discord
  prerequisites: |
    Созданный аккаунт Discord
  test-data: |
    empty
  steps: 
    - Нажать на кнопку Sign up
    - Нажать кнопку "Sign in with Discord"
  expected-result: |
    Пользователь успешно авторизован


- summary: |
    Проверка успешной авторизации
  requirement: |
    Пользователь может авторизоваться через электронную почту
  prerequisites: |
    empty
  test-data: |
    Email = test1111112@test.ru Password = password
  steps: 
    - Нажать на кнопку "Sign in"
    - Ввести Email
    - Ввести Password
    - Нажать "Submit"
  expected-result: |
    Пользователь успешно авторизован


- summary: |
    Проверка авторизации незарегистрированного пользователя
  requirement: |
    Пользователь не может авторизоваться под ранее незарегистрированной почтой
  prerequisites: |
    empty
  test-data: |
    Email = sfdfsafwfsdf@ssdfdf.ru Password = password
  steps: 
    - Нажать на кнопку "Sign in"
    - Ввести Email
    - Ввести Password
    - Нажать на Submit
  expected-result: |
    Авторизация не произошла, пользователь увидел информативное сообщение об ошибке


- summary: |
    Проверка восстановления пароля
  requirement: |
    Пользователь может восстановить пароль от своего email-аккаунта
  prerequisites: |
    Пользователь ранее зарегистрирован в системе.
    Пользователь не авторизован.
  test-data: |
    empty
  steps: 
    - На главной странице нажать на кнопку "Forgot password"
    - Ввести Email
    - Перейти по ссылке восстановления пароля из email
    - Ввести новый пароль и сохранить его
    - Авторизоваться на сайте под новым паролем
  expected-result: |
    Пользователь успешно авторизуется с новым паролем

- summary: |
    Проверка запуска пробной игры для неавторизованных пользователей
  requirement: |
    Неавторизованный пользователь может запустить пробную игру
  prerequisites: |
    empty
  test-data: |
    empty
  steps: 
    - На главной странице нажать на кнопку "Try simple battle"
  expected-result: |
    Открылось игровое окно пробной игры


- summary: |
    Проверка, что авторизованный пользователь может создать игру c ботом
  requirement: |
    Авторизованный пользователь может создать игру с ботом
  prerequisites: |
    Пользователь авторизовался в системе
  test-data: |
    empty
  steps: 
    - На главной странице нажать на кнопку "Create a game"
    - Выбрать любой Level, например, 3 звезды
    - Выбрать любой Game Type, например, with a bot
    - Установить желаемый Time Control, например, оставить значение по дефолту
    - Выбрать желаемую задачу в Choose task by name or tags, например, anagram_finder
    - Нажать на кнопку "Create battle"
  expected-result: |
    Открылось игровое окно игры с ботом


- summary: |
    Проверка, что пользователь может выбирать язык, на котором будет писать решение задачи
  requirement: |
    Пользователь может выбрать язык для решения задачи в игре
  prerequisites: |
    Авторизованный пользователь создал игру или подключился к битве в качестве игрока
  test-data: |
    empty
  steps: 
    - В открытом интерфейсе игры пользователь в дроп-меню может выбрать любой из представленных языков, например, Python
  expected-result: |
    Каркас решения задачи сменился в соответствии с требованиями выбранного языка. Например, в случае с Python функции начинаются с def.


- summary: |
    Проверка, что пользователь может выиграть игру
  requirement: |
    Пользователь может выиграть игру
  prerequisites: |
    empty
  test-data: |
    Код решения:
    const _ = require("lodash");
    const R = require("rambda");

    const solution = (width, length) => {
      return width * length;
    };

    module.exports = solution;
  steps: 
    - Создать игру с ботом, выбрав задачу, например, "rect_area"
    - Выбрать язык Node.js
    - В поле ввода кода ввести решение из тестовых данных
    - Нажать Run для проверки решения
    - В появившемся модальном окне 'Woohoo, you're Champion!!!!!' нажать на 'Thanks'
  expected-result: | 
    Игра заканчивается, пользователь остается в игровом окне.
    Справа на зеленом фоне надпись 'You have won the game!'
    Слева над результатом прогона тестов на заленом фоне надпись 'Yay! All tests passed!!!!!'


- summary: |
    Проверка, что пользователь может сдаться в игре
  requirement: |
    Пользователь может сдаться в игре
  prerequisites: |
    empty
  test-data: |
    empty
  steps: 
    - Создать любую игру
    - В игровом окне нажать на красной флажок "Give up"
    - В модальном окне подтвердить действие, нажав на красную кнопку Give up
    - В новом модальном окне 'If you read this you've lost the game' нажать на кнопку "I'll be back"
  expected-result: |
    Пользователь остается в игровом окне.
    Справа на красном фоне надпись 'Your opponent has won the game'.


- summary: |
    Проверка, что пользователь может наблюдать за игрой других пользователей в реалтайме
  requirement: |
    Пользователь может наблюдать за игрой других пользователей в реалтайме
  prerequisites: |
    Авторизован на сайте
  test-data: |
    emtpy
  steps: 
    - На главной странице в лобби найти игру с кнопкой "show" и нажать на нее
  expected-result: |
    Открывается игровое окно, где видно код обоих игроков и их сообщения в чате.


- summary: |
    Проверка, что пользователь может успешно принять приглашение в игру от другого игрока
  requirement: |
    Пользователь может присоединиться к игре по приглашению другого игрока
  prerequisites: |
    Аккаунт под email авторизован в одном браузере
    Несвязанный с ним аккаунт под Github авторизован в другом браузере
  test-data: |
    Level: 1 звезда
    Time Control: 8 min
    Choose task by name or tags: random  task
  steps: 
    - На главной странице нажать кнопку "Create game" от аккаунта, привязанного к email
    - Выбрать любой Game Type, например, "With a friend"
    - Выбрать в качестве оппонента аккаунт, привязанный к Github
    - Задать данные игры из тестовых данных
    - Нажать на кнопку "Create invite"
    - На аккаунте, привязанном к Github, нажать на иконку "Invites"
    - Принять приглашение пользователя
  expected-result: |
    После принятия приглашения у обоих пользователей открывается игровое окно


- summary: |
    Проверка, что в таблице рейтинга сортировка по rating работает правильно
  requirement: |
    Пользователь может отсортировать пользователей по Rank, Rating, Games Played, Joined в таблице рейтинга
  prerequisites: |
    Пользователь авторизован
  test-data: |
    empty
  steps: 
    - Перейти на https://codebattle.hexlet.io/users
    - Выбрать любой раздел, например, monthly
    - Отсортировать по любому полю, например, rating, по возрастанию
  expected-result: |
    Пользователи сортируются по указанному полю по возрастанию